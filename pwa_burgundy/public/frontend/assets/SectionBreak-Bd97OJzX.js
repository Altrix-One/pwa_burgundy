var _e=Object.defineProperty,ge=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var se=(i,e,l)=>e in i?_e(i,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[e]=l,q=(i,e)=>{for(var l in e||(e={}))Se.call(e,l)&&se(i,l,e[l]);if(ae)for(var l of ae(e))$e.call(e,l)&&se(i,l,e[l]);return i},B=(i,e)=>ge(i,ye(e));var H=(i,e,l)=>new Promise((s,d)=>{var t=a=>{try{u(l.next(a))}catch(n){d(n)}},o=a=>{try{u(l.throw(a))}catch(n){d(n)}},u=a=>a.done?s(a.value):Promise.resolve(a.value).then(t,o);u((l=l.apply(i,e)).next())});import{g as Ve,h as A,o as r,a as f,p as Z,G as J,j as k,f as z,t as g,m as le,b as c,H as ke,I as De,r as y,z as S,d as h,u as x,w as D,n as R,F as P,q as M,c as Ae,v as ee,J as we,l as O,_ as U,i as Te,D as ie,K as Fe,B as de,C as oe,T as Ce,x as Ne,y as ze}from"./index-W_lnXAtG.js";import{_ as te,A as ne}from"./TextInput.vue_vue_type_script_setup_true_lang-CdzQ2H2L.js";import{_ as j,a as Ue}from"./FormControl.vue_vue_type_script_setup_true_lang-DwYvdCJj.js";const Oe=Ve({__name:"Badge",props:{theme:{default:"gray"},size:{default:"md"},variant:{default:"subtle"},label:{}},setup(i){const e=i,l=A(()=>{let s={gray:"text-white bg-gray-900",blue:"text-white bg-blue-500",green:"text-white bg-green-600",orange:"text-white bg-amber-600",red:"text-white bg-red-600"}[e.theme],d={gray:"text-gray-700 bg-gray-100",blue:"text-blue-600 bg-blue-100",green:"text-green-800 bg-green-200",orange:"text-amber-700 bg-amber-100",red:"text-red-600 bg-red-100"}[e.theme],t={gray:"text-gray-700 bg-white border border-gray-300",blue:"text-blue-600 bg-white border border-blue-300",green:"text-green-800 bg-white border border-green-300",orange:"text-amber-700 bg-white border border-amber-300",red:"text-red-600 bg-white border border-red-300"}[e.theme],o={gray:"text-gray-700 bg-transparent",blue:"text-blue-600 bg-transparent",green:"text-green-800 bg-transparent",orange:"text-amber-700 bg-transparent",red:"text-red-600 bg-transparent"}[e.theme],u={subtle:d,solid:s,outline:t,ghost:o}[e.variant],a={sm:"h-4 text-xs px-1.5",md:"h-5 text-xs px-1.5",lg:"h-6 text-sm px-2"}[e.size];return[u,a]});return(s,d)=>(r(),f("div",{class:Z(["inline-flex select-none items-center gap-1 rounded-full",l.value])},[s.$slots.prefix?(r(),f("div",{key:0,class:Z([e.size=="lg"?"max-h-6":"max-h-4"])},[J(s.$slots,"prefix")],2)):k("",!0),J(s.$slots,"default",{},()=>{var t;return[z(g((t=e.label)==null?void 0:t.toString()),1)]}),s.$slots.suffix?(r(),f("div",{key:1,class:Z([e.size=="lg"?"max-h-6":"max-h-4"])},[J(s.$slots,"suffix")],2)):k("",!0)],2))}});class Le{constructor(){this.listeners={},this.failed=!1}on(e,l){this.listeners[e]=this.listeners[e]||[],this.listeners[e].push(l)}trigger(e,l){(this.listeners[e]||[]).forEach(d=>{d.call(this,l)})}upload(e,l){return new Promise((s,d)=>{let t=new XMLHttpRequest;t.upload.addEventListener("loadstart",()=>{this.trigger("start")}),t.upload.addEventListener("progress",a=>{a.lengthComputable&&this.trigger("progress",{uploaded:a.loaded,total:a.total})}),t.upload.addEventListener("load",()=>{this.trigger("finish")}),t.addEventListener("error",()=>{this.trigger("error"),d()}),t.onreadystatechange=()=>{if(t.readyState==XMLHttpRequest.DONE){let a;if(t.status===200){let n=null;try{n=JSON.parse(t.responseText)}catch(w){n=t.responseText}let v=n.message||n;s(v)}else if(t.status===403)a=JSON.parse(t.responseText);else{this.failed=!0;try{a=JSON.parse(t.responseText)}catch(n){}}a&&a.exc&&console.error(JSON.parse(a.exc)[0]),d(a)}};const o=l.upload_endpoint||"/api/method/upload_file";t.open("POST",o,!0),t.setRequestHeader("Accept","application/json"),window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&t.setRequestHeader("X-Frappe-CSRF-Token",window.csrf_token);let u=new FormData;e&&u.append("file",e,e.name),u.append("is_private",l.private?"1":"0"),u.append("folder",l.folder||"Home"),l.file_url&&u.append("file_url",l.file_url),l.doctype&&u.append("doctype",l.doctype),l.docname&&u.append("docname",l.docname),l.fieldname&&u.append("fieldname",l.fieldname),l.method&&u.append("method",l.method),l.type&&u.append("type",l.type),t.send(u)})}}const Ee={name:"FileUploader",props:["fileTypes","uploadArgs","validateFile"],data(){return{uploader:null,uploading:!1,uploaded:0,error:null,message:"",total:0,file:null,finishedUploading:!1}},computed:{progress(){let i=Math.floor(this.uploaded/this.total*100);return isNaN(i)?0:i},success(){return this.finishedUploading&&!this.error}},methods:{inputRef(){return this.$refs.input},openFileSelector(){this.$refs.input.click()},onFileAdd(i){return H(this,null,function*(){if(this.error=null,this.file=i.target.files[0],this.file&&this.validateFile)try{let e=yield this.validateFile(this.file);e&&(this.error=e)}catch(e){this.error=e}this.error||this.uploadFile(this.file)})},uploadFile(i){return H(this,null,function*(){this.error=null,this.uploaded=0,this.total=0,this.uploader=new Le,this.uploader.on("start",()=>{this.uploading=!0}),this.uploader.on("progress",e=>{this.uploaded=e.uploaded,this.total=e.total}),this.uploader.on("error",()=>{this.uploading=!1,this.error="Error Uploading File"}),this.uploader.on("finish",()=>{this.uploading=!1,this.finishedUploading=!0}),this.uploader.upload(i,this.uploadArgs||{}).then(e=>{this.$emit("success",e)}).catch(e=>{this.uploading=!1;let l="Error Uploading File";e!=null&&e._server_messages?l=JSON.parse(JSON.parse(e._server_messages)[0]).message:e!=null&&e.exc&&(l=JSON.parse(e.exc)[0].split(`
`).slice(-2,-1)[0]),this.error=l,this.$emit("failure",e)})})}},expose:["inputRef"]},Ie=["accept"];function qe(i,e,l,s,d,t){return r(),f("div",null,[c("input",{ref:"input",type:"file",accept:l.fileTypes,class:"hidden",onChange:e[0]||(e[0]=(...o)=>t.onFileAdd&&t.onFileAdd(...o))},null,40,Ie),J(i.$slots,"default",ke(De({file:d.file,uploading:d.uploading,progress:t.progress,uploaded:d.uploaded,message:d.message,error:d.error,total:d.total,success:t.success,openFileSelector:t.openFileSelector})))])}const Be=le(Ee,[["render",qe]]),Re={class:"p-2"},je={class:"flex"},He={class:"text-[12px] text-gray-600"},Je={key:0,class:"text-[12px] text-red-500 pl-1"},Y={__name:"Text",props:["field","frm","table","idx","idexValue"],setup(i){const{field:e,frm:l,table:s,idx:d,idexValue:t}=i,o=y(""),u=A(()=>e.read_only==1||l.Docstatus==1||l.Docstatus==2);if(S(l,a=>{e.value&&(o.value=e.value)}),t>=0){let a=l.doc[s][t][e.fieldname];o.value=a}return S(o,a=>{s?t>=0?l.setTableValue(e.fieldname,a,s,t):l.setTableValue(e.fieldname,a,s,d):l.setValue(e.fieldname,a),a&&(s?t>=0?l.doc[s][t][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[s][d][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0))}),(a,n)=>(r(),f("div",Re,[c("div",je,[c("p",He,g(i.field.label),1),i.field.reqd==1?(r(),f("p",Je,"*")):k("",!0)]),h(x(te),{type:"text",size:"sm",variant:"subtle",placeholder:i.field.label,disabled:u.value,modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=v=>o.value=v)},null,8,["placeholder","disabled","modelValue"])]))}},Pe={class:"p-2"},Me={class:"flex"},Ye={class:"text-[12px] text-gray-600"},Ge={key:0,class:"text-[12px] text-red-500 pl-1"},G={__name:"Select",props:["field","frm","table","idx","idexValue"],setup(i){const{field:e,frm:l,table:s,idx:d,idexValue:t}=i,o=y(""),u=A(()=>e.read_only==1||l.Docstatus==1||l.Docstatus==2);if(t>=0){let a=l.doc[s][t][e.fieldname];o.value=a}return S(l,a=>{e.value&&(o.value=e.value)}),S(()=>o.value,a=>{var v;const n=(v=a==null?void 0:a.value)!=null?v:a;o.value=n,s?t>=0?l.setTableValue(e.fieldname,n,s,t):l.setTableValue(e.fieldname,n,s,d):l.setValue(e.fieldname,n),a&&(s?t>=0?l.doc[s][t][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[s][d][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0))}),(a,n)=>(r(),f("div",Pe,[c("div",Me,[c("p",Ye,g(i.field.label),1),i.field.reqd==1?(r(),f("p",Ge,"*")):k("",!0)]),h(x(ne),{class:"mt-1",options:typeof i.field.options=="string"?i.field.options.split(`
`):i.field.options,modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=v=>o.value=v),size:"sm",variant:"subtle",label:i.field.label,placeholder:i.field.label,disabled:u.value,"hide-search":"true"},null,8,["options","modelValue","label","placeholder","disabled"])]))}},Xe={class:"p-2"},ue={__name:"Badge",props:["field","frm"],setup(i){const{field:e,frm:l}=i;return l.setValue(e.fieldname,e.label),(s,d)=>(r(),f("div",Xe,[h(x(Oe),{type:"text",size:"lg",theme:"gray",variant:"ghost",label:s.value},{default:D(()=>[z(g(i.field.label),1)]),_:1},8,["label"])]))}},Ke={class:"p-2"},Qe={class:"flex"},We={class:"text-[12px] text-gray-600"},Ze={key:0,class:"text-[12px] text-red-500 pl-1"},re={__name:"Int",props:["field","frm","table","idx","idexValue"],setup(i){const{field:e,frm:l,table:s,idx:d,idexValue:t}=i,o=y(""),u=A(()=>e.read_only==1||l.Docstatus==1||l.Docstatus==2);if(S(o,a=>{const n=parseInt(a,10);s?t>=0?l.setTableValue(e.fieldname,isNaN(n)?"":n,s,t):l.setTableValue(e.fieldname,isNaN(n)?"":n,s,d):l.setValue(e.fieldname,isNaN(n)?"":n),a&&(s?t>=0?l.doc[s][t][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[s][d][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0))}),t>=0){let a=l.doc[s][t][e.fieldname];o.value=a}return S(l,a=>{e.value&&(o.value=e.value)}),(a,n)=>(r(),f("div",Ke,[c("div",Qe,[c("p",We,g(i.field.label),1),i.field.reqd==1?(r(),f("p",Ze,"*")):k("",!0)]),h(x(te),{type:"number",size:"sm",variant:"subtle",placeholder:i.field.label,disabled:u.value,modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=v=>o.value=v),class:"mt-1"},null,8,["placeholder","disabled","modelValue"])]))}},el={class:"p-2"},ll={class:"flex"},tl={class:"text-[12px] text-gray-600"},al={key:0,class:"text-[12px] text-red-500 pl-1"},ce={__name:"DateTime",props:["field","frm","table","idx","idexValue"],setup(i){const{field:e,frm:l,table:s,idx:d,idexValue:t}=i,o=y(e.value||""),u=A(()=>e.read_only==1||l.Docstatus==1||l.Docstatus==2);if(S(o,a=>{s?t>=0?l.setTableValue(e.fieldname,a,s,t):l.setTableValue(e.fieldname,a,s,d):l.setValue(e.fieldname,a),a&&(s?t>=0?l.doc[s][t][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[s][d][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0))}),R(()=>{l.Saved==1&&(o.value=e.value)}),S(l,a=>{e.value&&(o.value=e.value)}),t>=0){let a=l.doc[s][t][e.fieldname];o.value=a}return(a,n)=>(r(),f("div",el,[c("div",ll,[c("p",tl,g(i.field.label),1),i.field.reqd==1?(r(),f("p",al,"*")):k("",!0)]),h(x(j),{modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=v=>o.value=v),type:"datetime-local",size:"sm",variant:"subtle",placeholder:i.field.label,disabled:u.value},null,8,["modelValue","placeholder","disabled"])]))}},sl={class:"p-2"},il={class:"flex"},dl={class:"text-[12px] text-gray-600"},ol={key:0,class:"text-[12px] text-red-500 pl-1"},fe={__name:"Autocomplete",props:["field","frm"],setup(i){const{field:e,frm:l}=i,s=A(()=>e.read_only==1||l.Docstatus==1||l.Docstatus==2);return S(()=>e.value,d=>{var o;const t=(o=d==null?void 0:d.value)!=null?o:d;e.value=t,l.setValue(e.fieldname,t),e.value&&l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0)}),(d,t)=>(r(),f("div",sl,[c("div",il,[c("p",dl,g(i.field.label),1),i.field.reqd==1?(r(),f("p",ol,"*")):k("",!0)]),h(x(ne),{options:typeof i.field.options=="string"?i.field.options.split(`
`):i.field.options,modelValue:i.field.value,"onUpdate:modelValue":t[0]||(t[0]=o=>i.field.value=o),size:"sm",variant:"subtle",label:i.field.label,placeholder:i.field.label,disabled:s.value,class:"mt-1"},null,8,["options","modelValue","label","placeholder","disabled"])]))}},nl={class:"p-2"},ul={class:"flex"},rl={class:"text-[12px] text-gray-600"},cl={key:0,class:"text-[12px] text-red-500 pl-1"},me={__name:"Date",props:["field","frm","table","idx","idexValue"],setup(i){const{field:e,frm:l,table:s,idx:d,idexValue:t}=i,o=y(e.value||""),u=A(()=>e.read_only==1||l.Docstatus==1||l.Docstatus==2);if(t>=0){let a=l.doc[s][t][e.fieldname];o.value=a}return S(o,a=>{s?t>=0?l.setTableValue(e.fieldname,a,s,t):l.setTableValue(e.fieldname,a,s,d):l.setValue(e.fieldname,a),a&&(s?t>=0?l.doc[s][t][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[s][d][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0))}),(a,n)=>(r(),f("div",nl,[c("div",ul,[c("p",rl,g(i.field.label),1),i.field.reqd==1?(r(),f("p",cl,"*")):k("",!0)]),h(x(j),{modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=v=>o.value=v),type:"date",size:"sm",variant:"subtle",placeholder:i.field.label,disabled:u.value},null,8,["modelValue","placeholder","disabled"])]))}},fl={class:"p-3"},ml={class:"flex"},vl={key:0,class:"text-[12px] text-red-500 pl-1"},ve={__name:"Checkbox",props:{field:Object,frm:Object,idexValue:Number,table:String,idx:Number},setup(i){const e=i,l=y(!1),s=A(()=>e.field.read_only==1||e.frm.Docstatus==1||e.frm.Docstatus==2);return S(e.field,d=>{d.value?l.value=!0:l.value=!1}),S(l,d=>{d?d=1:d=0,e.table?e.idexValue>=0?e.frm.setTableValue(e.field.fieldname,d,e.table,e.idexValue):e.frm.setTableValue(e.field.fieldname,d,e.table,e.idx):e.frm.setValue(e.field.fieldname,d),d&&(e.table?e.idexValue>=0?e.frm.doc[e.table][e.idexValue][e.field.fieldname]!=e.field.value&&(e.field.value=null,e.frm.Saved=0,e.frm.Submit=0,e.frm.Amend=0):e.frm.doc[e.table][e.idx][e.field.fieldname]!=e.field.value&&(e.field.value=null,e.frm.Saved=0,e.frm.Submit=0,e.frm.Amend=0):e.frm.doc[e.field.fieldname]!=e.field.value&&(e.field.value=null,e.frm.Saved=0,e.frm.Submit=0,e.frm.Amend=0))}),S(()=>e.frm,d=>{e.field.value===0?l.value=!1:e.field.value===1?l.value=!0:l.value=!1},{immediate:!0}),e.idexValue>=0&&(e.frm.doc[e.table][e.idexValue][e.field.fieldname]===0?l.value=!1:l.value=!0),R(()=>{e.field.value&&(l.value=e.field.value)}),(d,t)=>(r(),f("div",fl,[c("div",ml,[h(x(Ue),{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value=o),size:"sm",label:i.field.label,disabled:s.value},null,8,["modelValue","label","disabled"]),e.field.reqd==1?(r(),f("p",vl,"*")):k("",!0)])]))}},pl={class:"p-2"},hl={class:"flex"},bl={class:"text-[12px] text-gray-600"},xl={key:0,class:"text-[12px] text-red-500 pl-1"},X={__name:"Textarea",props:["field","frm","table","idx","idexValue"],setup(i){const{field:e,frm:l,table:s,idx:d,idexValue:t}=i,o=y(""),u=A(()=>e.read_only==1||l.Docstatus==1||l.Docstatus==2);if(S(l,a=>{e.value&&(o.value=e.value)}),t>=0){let a=l.doc[s][t][e.fieldname];o.value=a}return S(o,a=>{s?t>=0?l.setTableValue(e.fieldname,a,s,t):l.setTableValue(e.fieldname,a,s,d):l.setValue(e.fieldname,a),a&&(s?t>=0?l.doc[s][t][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[s][d][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0))}),(a,n)=>(r(),f("div",pl,[c("div",hl,[c("p",bl,g(i.field.label),1),i.field.reqd==1?(r(),f("p",xl,"*")):k("",!0)]),h(x(j),{type:"textarea",size:"sm",variant:"subtle",placeholder:i.field.label,disabled:u.value,modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=v=>o.value=v)},null,8,["placeholder","disabled","modelValue"])]))}},_l={class:"p-2"},gl={class:"flex"},yl={class:"text-[12px] text-gray-600"},Sl={key:0,class:"text-[12px] text-red-500 pl-1"},pe={__name:"Float",props:["field","frm","table","idx","idexValue"],setup(i){const{field:e,frm:l,table:s,idx:d,idexValue:t}=i,o=y(""),u=A(()=>e.read_only==1||l.Docstatus==1||l.Docstatus==2);R(()=>{let n;if(t>=0?n=l.doc[s][t][e.fieldname]:n=e.value,n!=null){const v=parseFloat(n);isNaN(v)||(o.value=v.toFixed(3))}}),S(o,n=>{const v=parseInt(n);isNaN(v)||(s?t>=0?l.setTableValue(e.fieldname,v,s,t):l.setTableValue(e.fieldname,v,s,d):l.setValue(e.fieldname,v)),n&&(s?t>=0?l.doc[s][t][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[s][d][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0))});const a=()=>{if(o.value!==""){const n=parseFloat(o.value);isNaN(n)||(o.value=n.toFixed(3))}};return S(l,n=>{if(e.value){const v=parseFloat(e.value);isNaN(v)||(o.value=v.toFixed(3))}}),(n,v)=>(r(),f("div",_l,[c("div",gl,[c("p",yl,g(i.field.label),1),i.field.reqd==1?(r(),f("p",Sl,"*")):k("",!0)]),h(x(te),{type:"text",size:"sm",variant:"subtle",placeholder:i.field.label,disabled:u.value,modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=w=>o.value=w),onBlur:a,class:"mt-1"},null,8,["placeholder","disabled","modelValue"])]))}},$l={class:"p-2"},Vl={class:"flex"},kl={class:"text-[12px] text-gray-600"},Dl={key:0,class:"text-[12px] text-red-500 pl-1"},Al={class:"relative w-full mt-1"},wl={key:0,class:"absolute left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg mt-1 z-20 max-h-48 overflow-y-auto no-scrollbar"},Tl=["onClick"],Fl={key:1,class:"p-2 hover:bg-gray-200 cursor-pointer text-[12px] text-gray-600"},Cl={__name:"Link",props:["field","frm","table","idx","idexValue"],setup(i){const{field:e,frm:l,table:s,idx:d,idexValue:t}=i,o=y(""),u=y(!1),a=y([]);if(S(l,b=>{e.value&&(o.value=e.value)}),t>=0){let b=l.doc[s][t][e.fieldname];o.value=b}const n=A(()=>e.read_only==1||l.Docstatus==1||l.Docstatus==2),v=b=>{o.value=b.doctype_name,s?t>=0?l.setTableValue(e.fieldname,b.name,s,t):l.setTableValue(e.fieldname,b.name,s,d):l.setValue(e.fieldname,b.name),b.name&&(s?t>=0?l.doc[s][t][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[s][d][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0)),u.value=!1},w=(b="")=>{const _=Ae({url:"frappe.desk.search.search_link",method:"POST",params:{doctype:e.options,ignore_user_permissions:0,page_length:10,reference_doctype:l.doctype,txt:b}});_.fetch().then(()=>{const $=_.data;$?a.value=$.map(F=>({name:F.value,doctype_name:F.value})):a.value=[]})};return S(o,b=>{w(b)}),R(()=>{w()}),document.addEventListener("click",b=>{b.target.closest(".relative")||(u.value=!1)}),(b,_)=>(r(),f("div",$l,[c("div",Vl,[c("p",kl,g(i.field.label),1),i.field.reqd==1?(r(),f("p",Dl,"*")):k("",!0)]),c("div",Al,[h(x(j),{type:"text",size:"sm",variant:"subtle",placeholder:i.field.label,disabled:n.value,modelValue:o.value,"onUpdate:modelValue":_[0]||(_[0]=$=>o.value=$),onFocus:_[1]||(_[1]=$=>u.value=!0),class:"flex-grow w-full pt-[3px]"},null,8,["placeholder","disabled","modelValue"]),u.value?(r(),f("div",wl,[a.value.length>0?(r(!0),f(P,{key:0},M(a.value,$=>(r(),f("div",{key:$.name,class:"p-2 hover:bg-gray-200 cursor-pointer",onClick:F=>v($)},g($.doctype_name),9,Tl))),128)):(r(),f("div",Fl," No Record Found "))])):k("",!0)])]))}},he=le(Cl,[["__scopeId","data-v-bd9784a9"]]),Nl={class:"p-2"},zl={class:"flex"},Ul={class:"text-[12px] text-gray-600"},Ol={key:0,class:"text-[12px] text-red-500 pl-1"},be={__name:"Currency",props:["field","frm","table","idx","idexValue"],setup(i){const{field:e,frm:l,table:s,idx:d,idexValue:t}=i,o=y(""),u=y(""),a=y([]),n=A(()=>e.read_only==1||l.Docstatus==1||l.Docstatus==2),v=()=>H(this,null,function*(){const b=ee({doctype:"Company",fields:["default_currency"],orderBy:"creation desc"});yield b.reload();const _=b.data;if(_.length>0)for(const $ of _){const F=ee({doctype:"Currency",fields:["symbol"],filters:{name:$.default_currency},orderBy:"creation desc"});yield F.reload();const L=F.data;if(L.length>0&&a.value.push(L[0].symbol),t>=0){let E=l.doc[s][t][e.fieldname];const I=a.value.length>0?a.value[0]:"";u.value=`${I}${E}`}}});S(l,b=>{if(e.value){e.value==null?(u.value=null,o.value=0):(u.value=e.value,o.value=e.value);const _=a.value.length>0?a.value[0]:"";u.value=`${_}${o.value}`}}),S(u,b=>{let _=b.replace(/[^0-9]/g,"");o.value=_,a.value.length>0&&a.value[0],_=parseInt(_),s?t>=0?l.setTableValue(e.fieldname,_,s,t):l.setTableValue(e.fieldname,_,s,d):l.setValue(e.fieldname,_),b&&(s?t>=0?l.doc[s][t][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[s][d][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0))});const w=b=>{const $=b.target.value.replace(/[^0-9]/g,"");o.value=$;const F=a.value.length>0?a.value[0]:"";u.value=`${F}${$}`};return R(()=>{v()}),(b,_)=>(r(),f("div",Nl,[c("div",zl,[c("p",Ul,g(i.field.label),1),i.field.reqd==1?(r(),f("p",Ol,"*")):k("",!0)]),h(x(j),{type:"text",size:"sm",variant:"subtle",placeholder:i.field.label,disabled:n.value,modelValue:u.value,"onUpdate:modelValue":_[0]||(_[0]=$=>u.value=$),onInput:w},null,8,["placeholder","disabled","modelValue"])]))}},Ll={key:0,class:"p-2"},El={class:"flex"},Il={class:"text-[12px] text-gray-600"},ql={key:0,class:"text-[12px] text-red-500 pl-1"},Bl={key:1,class:"p-2"},Rl={class:"text-[12px] text-gray-600 mb-1"},jl={class:"w-full h-[2rem] border-[1.5px] border-gray-200 rounded-lg"},Hl={class:"flex"},Jl={class:"pl-2 text-[10px] p-2 truncate w-[7rem] text-gray-600"},Pl={class:"pl-2 text-[10px] p-2 truncate w-[5rem] text-gray-600"},Ml={class:"pl-2 text-[10px] p-2 truncate w-[5rem] text-gray-600"},Yl={class:"font-semibold truncate w-[10rem]"},Gl={key:0},Xl=["src"],Kl={key:1},Ql=["src"],Wl={key:2},Zl=c("p",null,"Unsupported file type",-1),et=[Zl],lt={class:"w-full bg"},tt=c("h3",{class:"font-semibold"},"Confirm Deletion",-1),at={class:"w-full bg"},st={__name:"Attach",props:["field","frm","table","idx","idexValue","doctypeAttach"],setup(i){const{field:e,frm:l,table:s,idx:d,idexValue:t,doctypeAttach:o}=i,u=y("");if(t>=0){let V=l.doc[s][t][e.fieldname];u.value=V}else u.value=e.fieldname;const a=we({content_hash:"",creation:"",docstatus:0,doctype:"File",file_name:"",file_size:0,file_type:"",file_url:e.value,folder:"Home",idx:0,is_attachments_folder:0,is_folder:0,is_home_folder:0,is_private:0,modified:"",modified_by:"Administrator",name:"",owner:"Administrator",uploaded_to_dropbox:0,uploaded_to_google_drive:0});if(l.name){const V=ee({doctype:"File",filters:{file_url:u.value},fields:["*"]});V.reload().then(()=>{if(V.data.length>0){const m=V.data[0];Object.assign(a,{content_hash:m.content_hash||"",creation:m.creation||"",docstatus:m.docstatus||0,doctype:m.doctype||"File",file_name:m.file_name||"",file_size:m.file_size||0,file_type:m.file_type||"",file_url:m.file_url||"",folder:m.folder||"Home",idx:m.idx||0,is_attachments_folder:m.is_attachments_folder||0,is_folder:m.is_folder||0,is_home_folder:m.is_home_folder||0,is_private:m.is_private||0,modified:m.modified||"",modified_by:m.modified_by||"Administrator",name:m.name||"",owner:m.owner||"Administrator",uploaded_to_dropbox:m.uploaded_to_dropbox||0,uploaded_to_google_drive:m.uploaded_to_google_drive||0}),n.value=!0}}).catch(m=>{console.error("Error loading file data:",m)})}const n=y(!1),v=y(!1),w=y(!1),b=A(()=>{if(a.file_url){const V=new URL(window.location.href);return`${V.protocol}//${V.hostname}:8001${a.file_url}`}return""}),_=A(()=>a.file_type==="JPG"||a.file_type==="PNG"||a.file_type==="SVG"),$=A(()=>a.file_type==="PDF"),F=V=>{Object.assign(a,V),n.value=!0},L=()=>{w.value=!0},E=()=>{v.value=!0},I=()=>{w.value=!0},K=()=>{l.attachValues=l.attachValues.filter(m=>m.FeildName===e.fieldname),Fe({doctype:"File",name:a.name}).delete.submit().then(()=>{n.value=!1,Object.keys(a).forEach(m=>{a[m]=""}),l.attachValues=l.attachValues.filter(m=>m.name&&m.FeildName!==e.fieldname),w.value=!1}).catch(m=>{console.error("Error deleting file:",m)})};return S(a,V=>{s?t>=0?l.setTableValue(e.fieldname,V.file_url,s,t):l.setTableValue(e.fieldname,V.file_url,s,d):l.setValue(e.fieldname,V.file_url),l.attachValues.push({name:V.name,FeildName:e.fieldname}),V&&(s?t>=0?l.doc[s][t][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[s][d][e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0):l.doc[e.fieldname]!=e.value&&(e.value=null,l.Saved=0,l.Submit=0,l.Amend=0))}),(V,m)=>(r(),f("div",null,[n.value?k("",!0):(r(),f("div",Ll,[c("div",El,[c("p",Il,g(i.field.label),1),i.field.reqd==1?(r(),f("p",ql,"*")):k("",!0)]),h(x(Be),{fileTypes:["image/*","application/pdf"],validateFile:N=>{},onSuccess:F},{default:D(({openFileSelector:N,uploading:Q,progress:p})=>[h(x(O),{onClick:N,loading:Q},{default:D(()=>[z(" Attach "+g(p)+"% ",1)]),_:2},1032,["onClick","loading"])]),_:1})])),n.value?(r(),f("div",Bl,[c("p",Rl,g(i.field.label),1),c("div",jl,[c("div",{class:"flex hover:cursor-pointer",onClick:E},[c("div",Hl,[h(x(U),{name:"link-2",class:"w-4 h-4 mt-2 ml-2 text-gray-600 hover:text-black hover:cursor-pointer"}),c("p",Jl,"Name: "+g(a.file_name),1),c("p",Pl,"Size: "+g(a.file_size),1),c("p",Ml,"URL: "+g(a.file_url),1)]),h(x(U),{name:"x",class:"w-4 h-4 mt-2 ml-auto mr-2 text-gray-600 hover:text-black hover:cursor-pointer",onClick:Te(L,["stop"])})])])])):k("",!0),h(x(ie),{modelValue:v.value,"onUpdate:modelValue":m[1]||(m[1]=N=>v.value=N),class:"z-[200]"},{"body-title":D(()=>[c("h3",Yl,g(a.file_name),1)]),"body-content":D(()=>[_.value?(r(),f("div",Gl,[c("img",{src:b.value,alt:"Uploaded Image",class:"w-52 h-52"},null,8,Xl)])):$.value?(r(),f("div",Kl,[c("iframe",{src:b.value,class:"w-full h-[500px]",frameborder:"0"},null,8,Ql)])):(r(),f("div",Wl,et))]),actions:D(()=>[c("div",lt,[h(x(O),{variant:"solid",onClick:I},{default:D(()=>[z(" Delete ")]),_:1}),h(x(O),{class:"ml-2",onClick:m[0]||(m[0]=N=>v.value=!1)},{default:D(()=>[z(" Close ")]),_:1})])]),_:1},8,["modelValue"]),h(x(ie),{modelValue:w.value,"onUpdate:modelValue":m[3]||(m[3]=N=>w.value=N),class:"z-[210]"},{"body-title":D(()=>[tt]),"body-content":D(()=>[c("p",null,"Are you sure you want to delete this "+g(a.file_name)+" file?",1)]),actions:D(()=>[c("div",at,[h(x(O),{variant:"solid",onClick:K},{default:D(()=>[z(" Yes, Delete ")]),_:1}),h(x(O),{class:"ml-2",onClick:m[2]||(m[2]=N=>w.value=!1)},{default:D(()=>[z(" Cancel ")]),_:1})])]),_:1},8,["modelValue"])]))}},xe=i=>(Ne("data-v-62a41c7e"),i=i(),ze(),i),it={class:"p-2"},dt={class:"flex justify-between p-2"},ot={class:"text-[16px] text-gray-600"},nt={key:0,class:"max-h-[9.2rem] h-fit overflow-y-auto custom-scrollbar border-[1.5px] border-gray-300 rounded-md"},ut={key:0,class:"border-b-[0.5px] border-gray-300 w-full h-[3rem] p-2 flex content-center items-center"},rt={class:"ml-3"},ct={class:"text-[12px] text-gray-600 w-[12rem] truncate font-semibold"},ft={class:"flex mt-[2px]"},mt={class:"text-[10px] text-gray-600 w-[6rem] truncate"},vt={class:"text-[10px] text-gray-600 w-[6rem] truncate ml-2"},pt={key:1,class:"w-full h-[5rem] rounded-md mt-1 border-dashed border-[1px] border-gray-500 bg-gray-200 text-center"},ht=xe(()=>c("p",{class:"text-[12px] text-gray-700 mt-[2rem]"},"No record added",-1)),bt=[ht],xt={class:"p-2 border-b-[1.5px] border-gray-300 flex text-center"},_t={class:"font-semibold text-[20px] mt-1"},gt={class:"flex-1 overflow-y-auto custom-scrollbar p-2"},yt={key:1,class:"p-2"},St={class:"text-[14px] text-gray-600 font-semibold"},$t=xe(()=>c("hr",{class:"border-gray-300"},null,-1)),Vt={class:"flex border-t-[1.5px] border-gray-200 p-4"},kt={key:0},Dt={key:1},At={key:2,class:"ml-auto"},wt={key:3,class:"ml-auto"},Tt={__name:"Childtable",props:["field","frm"],setup(i){const e=i,l=y([]),s=y(!1),d=y(-1),t=y(0);let o=y(0),u=y(0);const a=y(!0);e.field.value&&e.field.value.forEach(C=>{l.value.push(B(q({},C),{index:t.value})),t.value+=1});const n=A(()=>e.field.read_only==1||e.frm.Docstatus==1||e.frm.Docstatus==2);S(e.field,p=>{p.value&&a.value&&(a.value=!1,v())});const v=()=>{e.field.value.length>0&&(e.field.value.forEach(p=>{l.value.push(B(q({},p),{index:t.value})),t.value+=1}),a.value=!1)},w=()=>{let p=e.frm.doc;if(p[e.field.fieldname][t.value]){let C=p[e.field.fieldname];l.value.push(B(q({},C[t.value]),{index:t.value})),t.value+=1}s.value=!1},b=()=>{if(l.value.length<=0)e.frm.doc[e.field.fieldname]=[];else{let p=d.value>-1?d.value:t.value;e.frm.doc[e.field.fieldname][p]=l.value[p]}s.value=!1,d.value=-1},_=()=>{s.value=!0},$=p=>{d.value=p,s.value=!0},F=()=>{let p=e.frm.doc;if(p[e.field.fieldname]){let C=p[e.field.fieldname];const T=l.value.findIndex(W=>W.index===d.value);T!==-1&&(l.value[T]=B(q({},C[d.value]),{index:d.value}))}s.value=!1},L=()=>{let p=0;d.value>-1?p=d.value:p=t.value,e.frm.removeTableVale(e.field.fieldname,p),JSON.stringify(l.value)!=JSON.stringify(e.field.value)&&(e.frm.Saved=0,e.frm.Submit=0,e.frm.Amend=0),l.value=l.value.filter(C=>C.index!==d.value),l.value.forEach(C=>{C.index>p&&C.index--}),s.value=!1,d.value=-1,t.value>0&&t.value--},E=p=>{o.value=p.touches[0].clientY},I=p=>{u.value=p.touches[0].clientY},K=()=>{u.value-o.value>50&&(s.value=!1)},V=p=>{p.style.transform="translateY(100%)",setTimeout(()=>{p.style.transform="translateY(0)"},10)},m=p=>{p.style.transform="translateY(0)",setTimeout(()=>{p.style.transform="translateY(100%)"},10)},N={Data:Y,Select:G,Int:re,Autocomplete:fe,Dynamic_Link:G,Heading:ue,Datetime:ce,Date:me,Check:ve,Text:Y,"Long Text":X,"Small Text":X,Float:pe,Link:he,Currency:be,Attach:st},Q=y(e.field.options);return(p,C)=>(r(),f("div",it,[c("div",dt,[c("p",ot,g(i.field.label),1),h(x(O),{onClick:_,disabled:n.value},{default:D(()=>[h(x(U),{name:"plus",class:"w-5 h-5 text-gray-700 hover:cursor-pointer"})]),_:1},8,["disabled"])]),l.value.length>0?(r(),f("div",nt,[(r(!0),f(P,null,M(l.value,(T,W)=>(r(),f("div",{key:W,class:"w-full rounded-md"},[T.fieldtype!=="Section Break"?(r(),f("div",ut,[h(x(U),{name:"file-text",class:"w-5 h-5 text-gray-600"}),c("div",rt,[c("p",ct,g(Object.values(T)[0]),1),c("div",ft,[c("p",mt,g(Object.values(T)[1]),1),c("p",vt,g(Object.values(T)[2]),1)])]),h(x(U),{name:"arrow-right",class:"w-5 h-5 text-gray-600 ml-auto hover:cursor-pointer hover:text-black",onClick:zt=>$(T.index)},null,8,["onClick"])])):k("",!0)]))),128))])):(r(),f("div",pt,bt)),s.value?(r(),f("div",{key:2,class:"fixed inset-0 bg-black opacity-50 z-[99] w-full sm:w-96",onClick:b})):k("",!0),h(Ce,{name:"slide-up",onEnter:V,onLeave:m},{default:D(()=>[s.value?(r(),f("div",{key:0,ref:"modal",class:"w-full sm:w-96 fixed bottom-0 left-0 h-[85vh] bg-white border-t border-gray-300 shadow-lg z-[100] flex flex-col touch-area",onTouchstart:E,onTouchmove:I,onTouchend:K},[c("div",xt,[c("h1",_t,g(i.field.label),1),h(x(U),{name:"x",onClick:b,class:"w-6 h-6 text-gray-700 mt-2 ml-auto hover:cursor-pointer"})]),c("div",gt,[(r(!0),f(P,null,M(Q.value,T=>(r(),f("div",{key:T.fieldname,class:"bg-white rounded-lg"},[T.fieldtype!=="Section Break"?(r(),de(oe(N[T.fieldtype]),{key:0,field:T,frm:i.frm,table:e.field.fieldname,idexValue:d.value,idx:t.value,doctypeAttach:e.field.options},null,8,["field","frm","table","idexValue","idx","doctypeAttach"])):(r(),f("div",yt,[c("p",St,g(T.label),1),$t]))]))),128))]),c("div",Vt,[n.value?(r(),f("div",Dt,[h(x(U),{name:"trash-2",class:"w-6 h-6 text-red-700 mt-1 hover:cursor-pointer hover:text-red-800"})])):(r(),f("div",kt,[h(x(U),{name:"trash-2",onClick:L,class:"w-6 h-6 text-red-700 mt-1 hover:cursor-pointer hover:text-red-800"})])),d.value>=0?(r(),f("div",At,[h(x(O),{variant:"solid",class:"w-[5rem] ml-auto",onClick:F,disabled:n.value},{default:D(()=>[z("Update")]),_:1},8,["disabled"])])):(r(),f("div",wt,[h(x(O),{variant:"solid",class:"w-[5rem] ml-auto",onClick:w,disabled:n.value},{default:D(()=>[z("Add")]),_:1},8,["disabled"])]))])],544)):k("",!0)]),_:1})]))}},Ft=le(Tt,[["__scopeId","data-v-62a41c7e"]]),Ct={class:"p-2 border-2 border-gray-300 rounded-md mb-4"},Nt={class:"font-semibold text-gray-600 mb-2"},It={__name:"SectionBreak",props:["field","frm"],setup(i){const{field:e,frm:l}=i,s={Data:Y,Select:G,Int:re,Autocomplete:fe,Dynamic_Link:G,Heading:ue,Datetime:ce,"Section Break":null,Date:me,Check:ve,Text:Y,"Long Text":X,"Small Text":X,Float:pe,Link:he,Currency:be,Table:Ft},d=A(()=>{const t=l.fields,o=t.indexOf(e),u=[];for(let a=o+1;a<t.length&&t[a].fieldtype!=="Section Break";a++)u.push(t[a]);return u});return(t,o)=>(r(),f("div",Ct,[c("h1",Nt,g(i.field.label),1),c("div",null,[(r(!0),f(P,null,M(d.value,u=>(r(),de(oe(s[u.fieldtype]),{key:u.fieldname,field:u,frm:i.frm},null,8,["field","frm"]))),128))])]))}};export{Ft as C,he as L,Y as _,G as a,re as b,fe as c,ue as d,ce as e,me as f,It as g,ve as h,X as i,pe as j,be as k,st as l};
